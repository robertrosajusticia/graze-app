{% extends "base.html" %}
{% block content %}
<div class="content animate-panel">
<div>
    <div class="row">
        <div class="col-lg-12">
            <div class="hpanel">
                <div class="panel-heading">
                    <div class="panel-tools">
                        <a class="showhide"><i class="fa fa-chevron-up"></i></a>
                        <a class="closebox"><i class="fa fa-times"></i></a>
                    </div>
                    {{ title }}
                </div>
                <div class="panel-body">

				    <h2>Select a service to execute</h2>
				    <p>
					    <select name="select_graze" id="select_graze"> 	
					    <option value="">Select</option>	    	
					    {% for dir in dirs %}    	
					    	<optgroup label="{{ dir.capitalize() }}">    		
					    		<option value="{{ dir+"_crawler.py" }}" site="{{ dir }}" service="crawler">{{ dir.capitalize() }} Crawler</option>
					    		<option value="{{ dir+"_scraper.py" }}" site="{{ dir }}" service="scraper">{{ dir.capitalize() }} Scraper</option>
					    	</optgroup>  			
					    {% endfor %}    
					    </select>   
					</p>

				    <p>
				    	<input id="button" class="ui-button" value="Execute">
				    </p>
				    
				</div>
    		</div>
    	</div>
    </div>
</div>
</div>

	<script>
	    $(function(){
	      $("#button").click( function() {
	      	  var selected = $("#select_graze")	      	  
			  //var site = $(':selected', selected).closest('optgroup').attr('label');	      	  
	          //var service = selected.val(); // get selected value
	          var site =  $(':selected', selected).attr("site");	          
	          var service =  $(':selected', selected).attr("service");	          
	          if (service) { // require a VALUE
	              window.location.replace("/execute?site="+site+"&service="+service); // redirect
	          }
	          return false;
	      });
	    });
	</script>    

{% endblock %}